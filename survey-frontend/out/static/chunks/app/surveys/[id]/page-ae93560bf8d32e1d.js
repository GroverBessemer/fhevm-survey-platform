(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48],{2099:(e,t,n)=>{Promise.resolve().then(n.bind(n,4466))},3186:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});let a={abi:[{inputs:[{internalType:"address",name:"_factory",type:"address"},{internalType:"address",name:"_creator",type:"address"},{internalType:"string",name:"_title",type:"string"},{internalType:"string",name:"_description",type:"string"},{internalType:"uint256",name:"_startTime",type:"uint256"},{internalType:"uint256",name:"_endTime",type:"uint256"},{internalType:"uint32",name:"_maxParticipants",type:"uint32"},{internalType:"enum Survey.PrivacyLevel",name:"_privacyLevel",type:"uint8"},{internalType:"bool",name:"_allowMultiple",type:"bool"},{components:[{internalType:"string",name:"questionText",type:"string"},{internalType:"enum Survey.QuestionType",name:"questionType",type:"uint8"},{internalType:"string[]",name:"options",type:"string[]"},{internalType:"bool",name:"required",type:"bool"}],internalType:"struct Survey.Question[]",name:"_questions",type:"tuple[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadySubmitted",type:"error"},{inputs:[],name:"InvalidTime",type:"error"},{inputs:[],name:"MaxParticipantsReached",type:"error"},{inputs:[],name:"NotAuthorized",type:"error"},{inputs:[],name:"SurveyEnded",type:"error"},{inputs:[],name:"SurveyNotActive",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"participant",type:"address"},{indexed:!1,internalType:"uint256",name:"questionCount",type:"uint256"}],name:"AnswerSubmitted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"}],name:"ResultsDecryptionAllowed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"}],name:"SurveyClosed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"creator",type:"address"},{indexed:!1,internalType:"string",name:"title",type:"string"}],name:"SurveyCreated",type:"event"},{inputs:[],name:"allowMyAnswersDecryption",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"allowResultsDecryption",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"closeSurvey",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"factory",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentParticipants",outputs:[{internalType:"euint32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getHasSubmitted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"questionId",type:"uint256"},{internalType:"uint256",name:"optionId",type:"uint256"}],name:"getOptionCount",outputs:[{internalType:"euint32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getQuestion",outputs:[{internalType:"string",name:"questionText",type:"string"},{internalType:"enum Survey.QuestionType",name:"questionType",type:"uint8"},{internalType:"string[]",name:"options",type:"string[]"},{internalType:"bool",name:"required",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getQuestionCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"questionId",type:"uint256"},{internalType:"address",name:"user",type:"address"}],name:"getUserAnswer",outputs:[{internalType:"euint32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"hasSubmitted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"optionCounts",outputs:[{internalType:"euint32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"protocolId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"questions",outputs:[{internalType:"string",name:"questionText",type:"string"},{internalType:"enum Survey.QuestionType",name:"questionType",type:"uint8"},{internalType:"bool",name:"required",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"externalEuint32[]",name:"encryptedAnswers",type:"bytes32[]"},{internalType:"bytes",name:"inputProof",type:"bytes"}],name:"submitAnswers",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"surveyInfo",outputs:[{internalType:"address",name:"creator",type:"address"},{internalType:"string",name:"title",type:"string"},{internalType:"string",name:"description",type:"string"},{internalType:"uint256",name:"startTime",type:"uint256"},{internalType:"uint256",name:"endTime",type:"uint256"},{internalType:"euint32",name:"maxParticipants",type:"bytes32"},{internalType:"euint32",name:"currentParticipants",type:"bytes32"},{internalType:"enum Survey.PrivacyLevel",name:"privacyLevel",type:"uint8"},{internalType:"bool",name:"allowMultipleSubmissions",type:"bool"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"userAnswers",outputs:[{internalType:"euint32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"}]}},4466:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var a=n(5155),s=n(8506),i=n(8029),r=n(6046),l=n(8173),u=n.n(l);function o(){let e=(0,r.useParams)().id,{surveyInfo:t,questions:n,isLoading:l}=(0,i.Y)(e);if(l)return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800",children:[(0,a.jsx)(s.V,{}),(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:(0,a.jsxs)("div",{className:"glass p-12 rounded-2xl text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading survey..."})]})})]});if(!t)return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800",children:[(0,a.jsx)(s.V,{}),(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:(0,a.jsxs)("div",{className:"glass p-12 rounded-2xl text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"❌"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Survey Not Found"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The survey you're looking for doesn't exist or has been removed."}),(0,a.jsx)(u(),{href:"/surveys",className:"inline-block px-6 py-3 bg-primary text-white rounded-lg hover:bg-blue-600 transition-all",children:"Browse Surveys"})]})})]});let o=Math.floor(Date.now()/1e3)>Number(t.endTime)?"ended":"active";return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800",children:[(0,a.jsx)(s.V,{}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[(0,a.jsxs)("div",{className:"glass p-8 rounded-2xl mb-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-semibold ".concat("active"===o?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:"active"===o?"\uD83D\uDFE2 Active":"⚫ Ended"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Contract: ",e.slice(0,6),"...",e.slice(-4)]})]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:t.title}),t.description&&(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:t.description}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDC64"}),(0,a.jsxs)("span",{children:["Creator: ",t.creator.slice(0,6),"...",t.creator.slice(-4)]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCCA"}),(0,a.jsx)("span",{children:"Participants: \uD83D\uDD12 Encrypted"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCC5"}),(0,a.jsxs)("span",{children:["Start: ",new Date(1e3*Number(t.startTime)).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCC5"}),(0,a.jsxs)("span",{children:["End: ",new Date(1e3*Number(t.endTime)).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"❓"}),(0,a.jsxs)("span",{children:["Questions: ",n.length]})]})]})]}),"active"===o&&(0,a.jsx)(u(),{href:"/surveys/".concat(e,"/participate"),className:"px-6 py-3 bg-primary text-white rounded-lg hover:bg-blue-600 transition-all font-semibold shadow-lg",children:"\uD83D\uDCDD Participate"})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 mt-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Survey Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"glass p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"Max Participants"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDD12 Encrypted"})]}),(0,a.jsxs)("div",{className:"glass p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"Privacy Level"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Creator Only","Public After End","Participants Can View"][t.privacyLevel]||"Creator Only"})]}),(0,a.jsxs)("div",{className:"glass p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"Multiple Submissions"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.allowMultipleSubmissions?"Allowed":"Not Allowed"})]}),(0,a.jsxs)("div",{className:"glass p-4 rounded-lg",children:[(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"Status"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.active?"Active":"Inactive"})]})]})]})]}),(0,a.jsxs)("div",{className:"glass p-6 rounded-xl",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"\uD83D\uDD12 Privacy Protected"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"All responses to this survey are encrypted on-chain using FHEVM technology. Only authorized parties can decrypt the results based on the privacy settings."})]})]})]})}},8029:(e,t,n)=>{"use strict";n.d(t,{Y:()=>l});var a=n(2115),s=n(5631),i=n(9959),r=n(3186);function l(e){let{signer:t}=(0,i.v)(),[n,l]=(0,a.useState)(null),[u,o]=(0,a.useState)(null),[p,y]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!t||!e){l(null);return}try{let n=new s.NZ(e,r.L.abi,t);l(n),console.log("[useSurvey] Contract initialized:",e)}catch(e){console.error("[useSurvey] Failed to initialize contract:",e),l(null)}},[t,e]),(0,a.useEffect)(()=>{(async()=>{if(n){c(!0),x(null);try{console.log("[useSurvey] Loading survey data...");let e=n.getFunction("surveyInfo"),t=await e();console.log("[useSurvey] Survey info:",t),o({creator:t.creator,title:t.title,description:t.description,startTime:t.startTime,endTime:t.endTime,maxParticipants:t.maxParticipants,currentParticipants:t.currentParticipants,privacyLevel:t.privacyLevel,allowMultipleSubmissions:t.allowMultipleSubmissions,active:t.active});let a=n.getFunction("getQuestion"),s=[],i=0;for(;;)try{let e=await a(i),t={questionText:e[0],questionType:Number(e[1]),options:Array.isArray(e[2])?e[2]:[],required:!!e[3]};console.log("[useSurvey] Question ".concat(i,":"),{text:t.questionText,type:t.questionType,optionsCount:t.options.length,options:t.options,required:t.required}),s.push(t),i++}catch(e){console.log("[useSurvey] No more questions after index ".concat(i));break}console.log("[useSurvey] Total loaded questions:",s.length),y(s),c(!1)}catch(e){console.error("[useSurvey] Failed to load survey data:",e),x(e instanceof Error?e:Error(String(e))),c(!1)}}})()},[n]),{contract:n,surveyInfo:u,questions:p,isLoading:d,error:m}}},6046:(e,t,n)=>{"use strict";var a=n(6658);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[250,506,441,517,358],()=>t(2099)),_N_E=e.O()}]);